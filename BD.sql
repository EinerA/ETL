CREATE DATABASE ENTREGA

USE ENTREGA

CREATE TABLE CAMIONERO(
FFC VARCHAR(20) PRIMARY KEY,
NOMBRE VARCHAR(20),
TELEFONO VARCHAR(10),
DIRECCION VARCHAR(20),
SALARIO REAL,
POBLACION VARCHAR(10)
)

CREATE TABLE CAMIONES(
PLACA VARCHAR(20) PRIMARY KEY,
MODELO VARCHAR(20),
TIPO VARCHAR(20),
POTENCIA VARCHAR(10)
)


CREATE TABLE CAMIONERO_CAMIONES(
FFC VARCHAR(20),
PLACA VARCHAR(20),
PRIMARY KEY(FFC,PLACA),
FOREIGN KEY (FFC) REFERENCES CAMIONERO(FFC),
FOREIGN KEY (PLACA) REFERENCES CAMIONES(PLACA)
)

CREATE TABLE CIUDAD(
APARADOPOSTAL VARCHAR(10) PRIMARY KEY,
NOMBRE VARCHAR(15)
)

CREATE TABLE PAQUETES(
CODPAQUETE VARCHAR(10) PRIMARY KEY,
DESCRIPCION VARCHAR(20),
DESTINO VARCHAR(10),
DIRDESTINATARIO VARCHAR(20),
APARADOPOSTAL VARCHAR(10),
FFC VARCHAR(20),
FOREIGN KEY (APARADOPOSTAL) REFERENCES CIUDAD(APARADOPOSTAL),
FOREIGN KEY (FFC) REFERENCES CAMIONERO(FFC)
)

CREATE TABLE CLIENTES(
DOCUMENTO VARCHAR(10) PRIMARY KEY,
NOMBRE VARCHAR(20),
APELLIDO  VARCHAR(10),
TELEFONO VARCHAR(20),
DIRECCION VARCHAR(10)
)

CREATE TABLE ENVIOS(
ID VARCHAR(10) PRIMARY KEY,
DOCUMENTO VARCHAR(10),
CODPAQUETE VARCHAR(10),
VRENVIO REAL,
IDFECHA VARCHAR(10),
FOREIGN KEY (DOCUMENTO) REFERENCES CLIENTES(DOCUMENTO),
FOREIGN KEY (CODPAQUETE) REFERENCES PAQUETES(CODPAQUETE),
FOREIGN KEY (IDFECHA) REFERENCES FECHA_ENVIOS(ID)
)

CREATE TABLE FECHA_ENVIOS(
ID VARCHAR(10) PRIMARY KEY,
DIA VARCHAR(10),
MES VARCHAR(10),
AÑO VARCHAR(5)
)

INSERT INTO CLIENTES VALUES ('12345','ARMANDO','SOTO','9378932','CRA22#76');
INSERT INTO CLIENTES VALUES ('54321','ARTURO','VELEZ','8973621','CRA76#65');
INSERT INTO CLIENTES VALUES ('345612','PEPO','RAMIREZ','2653712','CRA4#87');
INSERT INTO CLIENTES VALUES ('67890','PEPITO','CASAS','2786235','CRA94#8');
INSERT INTO CLIENTES VALUES ('298765','SARA','DIAZ','8762523','CRA23#2');

INSERT INTO FECHA_ENVIOS VALUES ('1','12','11','2010');
INSERT INTO FECHA_ENVIOS VALUES ('2','20','10','2014');
INSERT INTO FECHA_ENVIOS VALUES ('3','21','12','2015');
INSERT INTO FECHA_ENVIOS VALUES ('4','15','06','2017');
INSERT INTO FECHA_ENVIOS VALUES ('5','18','09','2013');


INSERT INTO ENVIOS VALUES ('1','12345','001','50000','3');
INSERT INTO ENVIOS VALUES ('2','54321','002','25000','3');
INSERT INTO ENVIOS VALUES ('3','12345','003','15000','2');
INSERT INTO ENVIOS VALUES ('4','54321','004','65000','1');
INSERT INTO ENVIOS VALUES ('5','54321','005','42000','3');

INSERT INTO CAMIONERO VALUES('1','Jaime','2147544','crr la verg numero 8','2345554','sampateste');
INSERT INTO CAMIONERO VALUES('2','Jaimito','21476844','crr la mon numero 4','2345555','sampaleste');
INSERT INTO CAMIONERO VALUES('3','Jaimillo','2145544','crr la verd numero 9','23444554','sampila');
INSERT INTO CAMIONERO VALUES('4','Jairo','557544','crr la virg numero 4','277885554','sampilaste');
INSERT INTO CAMIONERO VALUES('5','Jairito','21557544','crr la vera numero 1','2354545654','sampateste');

INSERT INTO CAMIONES VALUES ('JDK245','1998','TRACTOR','5000');
INSERT INTO CAMIONES VALUES ('JSD531','2006','MULA','8000');
INSERT INTO CAMIONES VALUES ('KGJ545','2005','4X4','1600');
INSERT INTO CAMIONES VALUES ('JFH245','2003','20X20','4500');
INSERT INTO CAMIONES VALUES ('OKG874','2010','CAMIONETA','1800');

INSERT INTO CIUDAD VALUES ('051','CALI');
INSERT INTO CIUDAD VALUES ('054','MEDELLIN');
INSERT INTO CIUDAD VALUES ('057','MANIZALES');
INSERT INTO CIUDAD VALUES ('048','BOGOTA');
INSERT INTO CIUDAD VALUES ('049','PEREIRA');

INSERT INTO PAQUETES VALUES ('001','MEDICINA','CALI','crr la PEN numero 1','051','1');
INSERT INTO PAQUETES VALUES ('002','JUGUETES','MEDELLIN','crr 46 numero 31','054','2');
INSERT INTO PAQUETES VALUES ('003','ROPA','MANIZALES','crr 87 numero 13','057','3');
INSERT INTO PAQUETES VALUES ('004','REPUESTOS','MEDELLIN','crr 85 numero 1','054','2');
INSERT INTO PAQUETES VALUES ('005','PAPELERIA','PEREIRA','crr 76 numero 91','049','5');

INSERT INTO CAMIONERO_CAMIONES VALUES ('1','JDK245');
INSERT INTO CAMIONERO_CAMIONES VALUES ('2','JFH245');
INSERT INTO CAMIONERO_CAMIONES VALUES ('3','JSD531');
INSERT INTO CAMIONERO_CAMIONES VALUES ('4','OKG874');
INSERT INTO CAMIONERO_CAMIONES VALUES ('5','KGJ545');



GO
----CONSULTAS --------

SELECT COUNT(P.DIRDESTINATARIO) AS NROENVIOS FROM PAQUETES P
WHERE P.DIRDESTINATARIO = 'crr 87 numero 13'

SELECT EN.VRENVIO AS VrEnvioCliente
FROM ENVIOS EN
WHERE DOCUMENTO = '12345'


SELECT COUNT(EN.IDFECHA) AS ENVIO_X_DIA
FROM ENVIOS EN 
WHERE EN.IDFECHA = '3'

SELECT COUNT(PA.APARADOPOSTAL) AS ENVIOS_X_PROVINCIA
FROM PAQUETES PA
WHERE PA.APARADOPOSTAL = '054'

SELECT COUNT(PA.CODPAQUETE) AS PAQUETE_X_CAMION
FROM CAMIONES C INNER JOIN CAMIONERO_CAMIONES CC
ON C.PLACA = CC.PLACA
INNER JOIN CAMIONERO CA
ON CA.FFC = CC.FFC
INNER JOIN PAQUETES PA
ON PA.FFC = CA.FFC
WHERE C.PLACA = 'JFH245'

SELECT COUNT(C.PLACA) AS CAMIONES_X_CIUDAD
FROM CAMIONES C INNER JOIN CAMIONERO_CAMIONES CC
ON C.PLACA = CC.PLACA
INNER JOIN CAMIONERO CA
ON CA.FFC = CC.FFC
INNER JOIN PAQUETES PA
ON PA.FFC = CA.FFC
INNER JOIN CIUDAD CI
ON PA.APARADOPOSTAL = CI.APARADOPOSTAL
WHERE CI.APARADOPOSTAL = '054'



